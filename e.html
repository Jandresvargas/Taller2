<!DOCTYPE html>
<html>
<head>
  <title>Mapa con sidebar y botón para mostrar información</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css" />
  <!-- plugin jquery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>  
  

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.EasyButton/2.4.0/easy-button.css" />

  <link rel="stylesheet" href="leaflet-sidebar/src/L.Control.Sidebar.css" />
  <script src="leaflet-sidebar/src/L.Control.Sidebar.js"></script>

  
  
  <style>
    #map {
      height: 400px;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet@0.7.2/dist/leaflet.js"></script>


  <script>
    // Crear mapa
    var map = L.map('map').setView([51.505, -0.09], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: 'Map data &copy; OpenStreetMap contributors'
        }).addTo(map);

    // Crear sidebar
    var sidebar = L.control.sidebar({
        autopan: false,       // whether to maintain the centered map point when opening the sidebar
        closeButton: true,    // whether t add a close button to the panes
        container: 'sidebar', // the DOM container or #ID of a predefined sidebar container that should be used
        position: 'left',     // left or right
    }).addTo(map);
    sidebar
            .addPanel({
                id:   'js-api',
                tab:  '<i class="fa fa-gear"></i>',
                title: 'JS API',
                pane: '<p>The Javascript API allows to dynamically create or modify the panel state.<p/><p><button onclick="sidebar.enablePanel(\'mail\')">enable mails panel</button><button onclick="sidebar.disablePanel(\'mail\')">disable mails panel</button></p><p><button onclick="addUser()">add user</button></b>',
            })
            // add a tab with a click callback, initially disabled
            .addPanel({
                id:   'mail',
                tab:  '<i class="fa fa-envelope"></i>',
                title: 'Messages',
                button: function() { alert('opened via JS callback') },
                disabled: true,
            })

        // be notified when a panel is opened
        sidebar.on('content', function (ev) {
            switch (ev.id) {
                case 'autopan':
                sidebar.options.autopan = true;
                break;
                default:
                sidebar.options.autopan = false;
            }
        });

    // Crear contenido del sidebar
    function createSidebarContent(data) {
      var content = "<h3>Información de la base de datos</h3>" +
                    "<p>ID: " + data.id + "</p>" +
                    "<p>Nombre: " + data.nombre + "</p>" +
                    "<p>Tipo: " + data.tipo + "</p>";
      return content;
    }

    // Crear botón EasyButton
    var infoButton = L.easyButton('fa-info-circle', function() {
      $.ajax({
        url: "bdg/c.php",
        type: "GET",
        dataType: "json",
        success: function(data) {
          var content = createSidebarContent(data);
          sidebar.setContent(content);
          sidebar.show();
        },
        error: function(xhr, status, error) {
          console.log("Error: " + error);
        }
      });
    }, "Mostrar información");

    // Añadir botón al mapa
    infoButton.addTo(map);
  </script>
</body>
</html>
