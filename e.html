<!DOCTYPE html>
<html>
<head>
  <title>Mapa con sidebar y botón para mostrar información</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css" />
  <!-- plugin jquery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"></script>  

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.EasyButton/2.4.0/easy-button.css" />


  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sidebar/0.2.2/js/sidebar.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sidebar/0.2.2/css/sidebar.css" />
  <style>
    #map {
      height: 400px;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>


  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>


  <script>
    // Crear mapa
    var map = L.map('map').setView([51.505, -0.09], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
      maxZoom: 18,
    }).addTo(map);

    // Crear sidebar
    var side = L.control.sidebar({
      autopan: false,
      closeButton: true,
      container: 'sidebar',
      position: 'right'
    }).addTo(map);


    sidebar
            .addPanel({
                id:   'js-api',
                tab:  '<i class="fa fa-gear"></i>',
                title: 'JS API',
                pane: '<p>The Javascript API allows to dynamically create or modify the panel state.<p/><p><button onclick="sidebar.enablePanel(\'mail\')">enable mails panel</button><button onclick="sidebar.disablePanel(\'mail\')">disable mails panel</button></p><p><button onclick="addUser()">add user</button></b>',
            })
            // add a tab with a click callback, initially disabled
            .addPanel({
                id:   'mail',
                tab:  '<i class="fa fa-envelope"></i>',
                title: 'Messages',
                button: function() { alert('opened via JS callback') },
                disabled: true,
            })

        // be notified when a panel is opened
        sidebar.on('content', function (ev) {
            switch (ev.id) {
                case 'autopan':
                sidebar.options.autopan = true;
                break;
                default:
                sidebar.options.autopan = false;
            }
        });

    // Crear contenido del sidebar
    function createSidebarContent(data) {
      var content = "<h3>Información de la base de datos</h3>" +
                    "<p>ID: " + data.id + "</p>" +
                    "<p>Nombre: " + data.nombre + "</p>" +
                    "<p>Tipo: " + data.tipo + "</p>";
      return content;
    }

    // Crear botón EasyButton
    var infoButton = L.easyButton('fa-info-circle', function() {
      $.ajax({
        url: "bdg/c.php",
        type: "GET",
        dataType: "json",
        success: function(data) {
          var content = createSidebarContent(data);
          sidebar.setContent(content);
          sidebar.show();
        },
        error: function(xhr, status, error) {
          console.log("Error: " + error);
        }
      });
    }, "Mostrar información");

    // Añadir botón al mapa
    infoButton.addTo(map);
  </script>
</body>
</html>
